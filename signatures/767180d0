impl_purchase(address,bool,bool)